<div class="container">

  <h2> {{ titulo }} <small> | SICDOC.</small></h2>
  <hr class="colorgraph">

  <!-- Loader de Carga de los Datos -->
  <div id="loader-2" *ngIf="loading == 'show'" style="margin-left:45%; margin-top:5%; margin-bottom:5%;">
    <!-- <img src="assets/images/aguarde.gif" alt="Cargando Tareas"> -->
    <img src="assets/images/832.gif" alt="Cargando Tareas">
  </div>

  <!-- Fila para el Area de Busqueda de los Oficios -->
  <!-- <div class="row-fluid" *ngIf="loadTabla1 == true">
    <div class="col-xs-12 col-md-12 col-lg-12">
    <h4>Buscar por:
    <input type="radio" name="codCorr" [(ngModel)]="codCorr" value="temaComunicacion" >Tema |
    <input type="radio" name="codCorr" [(ngModel)]="codCorr" value="codCorrespondenciaEnc"  >No. Interno |
    <input type="radio" name="codCorr" [(ngModel)]="codCorr" value="codReferenciaSreci" >No. Ingresado |
    <input type="radio" name="codCorr" [(ngModel)]="codCorr" value="descCorrespondenciaEnc" >Descripción
    </h4>
      <input class="form-control" type="text" name="search"  [(ngModel)]="search" placeholder="Buscar" >
    </div>
  </div> -->

  <hr>

  <!-- Fila para la tabla Principal de la ventana de finalizar Oficio -->
  <div class="col-xs-12 col-md-12 col-lg-12" *ngIf="loadTabla1 == true">
    <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%"   >
        <thead >
            <tr>
              <th>Estado</th>
              <th>Código Interno</th>
              <th>Código Ingresado</th>
              <th>Institución Remitente</th>
              <th>Tema de Comunicación</th>
              <!-- <th>Fecha Creación</th> -->
              <!-- <th>Fecha Entrega.</th> -->
              <th>Accion</th>
            </tr>
        </thead>

        <tbody >
            <tr *ngFor="let item of JsonOutgetlistaOficiosAll | searchfilter:codCorr:search ">
              <td [ngClass]="{ 'text-warning': item.idEstado == 3, 'text-info' : item.idEstado == 8,
                              'text-success': item.idEstado == 7 }" >
                <!-- <p class="alert alert-primary"> -->
                  {{ item.descripcionEstado }}
                <!-- </p> -->
              </td>
              <td> {{ item.codCorrespondenciaEnc }} </td>
              <td> {{ item.codReferenciaSreci }} </td>
              <td style="cursor: help" title="Descripcion: {{ item.perfilInstitucion }}"> {{ item.descInstitucion }} </td>
              <td> {{ item.temaComunicacion }} </td>
                <!-- <td> {{ timeConverter( item.fechaMaxEntrega.timestamp )  }} </td> -->
              <!-- <td> {{ item.fechaIngreso.timestamp | generateDate }} </td> -->
              <!-- <td> {{ item.fechaMaxEntrega.timestamp | generateDate }} </td> -->
              <td> <a *ngIf="item.idEstado == 3 && item.idTipoDocumento == 1
                        && item.idTipoComunicacion == 1 "
                    href="/#" (click)="datoOficio( item.codCorrespondenciaEnc, item.codReferenciaSreci,
                                                         item.idDeptoFuncional,
                                                         item.nombre1Funcionario, item.apellido1Funcionario,
                                                         item.nombre2Funcionario, item.apellido2Funcionario,
                                                         item.idFuncionario, item.idEstado, item.idCorrespondenciaEnc,
                                                         item.idTipoDocumento, item.idTipoComunicacion );
                                                         listarCodigoCorrespondenciaAgregarActividad(item.idTipoDocumento, item.idTipoComunicacion);"
                     data-toggle="modal" data-target="#t_and_c_m2" >
                     <!-- <i class="material-icons" data-placement="top" title="Comunicacion de Respuesta">create_new_folder</i> -->
                     <img src="/assets/icons/comunicacion/test_green_24x24.png" class="d-inline-block align-top" alt="" title="Comunicacion de Respuesta" >
                  </a>
                  <!-- <a *ngIf="item.idEstado.idEstado == 3 " -->
                  <a *ngIf="item.idEstado == 3 && item.idTipoDocumento != 1 "
                     href="/#" (click)="datoOficio( item.codCorrespondenciaEnc, item.codReferenciaSreci,
                                                         item.idDeptoFuncional,
                                                         item.nombre1Funcionario, item.apellido1Funcionario,
                                                         item.nombre2Funcionario, item.apellido2Funcionario,
                                                         item.idFuncionario, item.idEstado, item.idCorrespondenciaEnc,
                                                         item.idTipoDocumento, item.idTipoComunicacion );
                                                         listarCodigoCorrespondenciaAgregarActividad(item.idTipoDocumento, item.idTipoComunicacion);"
                          data-toggle="modal" data-target="#t_and_c_m3" >
                    <!-- <i class="material-icons" data-toggle="tooltip" data-placement="top" title="Agregar Actividad a Comunicacion" >assignment</i> -->
                    <img src="/assets/icons/comunicacion/written-page_brow_24x24.png" class="d-inline-block align-top" alt="" title="Agregar Actividad a Comunicacion">
                  </a>
                  <a href="/#" (click)="datoOficio( item.codCorrespondenciaEnc, item.codReferenciaSreci,
                                                         item.idDeptoFuncional,
                                                         item.nombre1Funcionario, item.apellido1Funcionario,
                                                         item.nombre2Funcionario, item.apellido2Funcionario,
                                                         item.idFuncionario, item.idEstado, item.idCorrespondenciaEnc,
                                                         item.idTipoDocumento, item.idTipoComunicacion );
                                                         listarCodigoCorrespondenciaAgregarActividad(item.idTipoDocumento, item.idTipoComunicacion);"
                          data-toggle="modal" data-target="#t_and_c_m" >
                      <!-- <i class="material-icons" data-toggle="tooltip" data-placement="top" title="Finalizar Comunicacion" >assignment_turned_in</i> -->
                      <img src="/assets/icons/comunicacion/verified-text-paper_blue_24x24.png" class="d-inline-block align-top" alt="" title="Finalizar Comunicacion" >
                  </a>

              </td>
            </tr>
        </tbody>
    </table>
</div>


<!-- Modal de Finalizar Actividad -->
<div *ngIf="idEstadoModal != 5 " class="modal fade" id="t_and_c_m" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
      data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" > <i class="material-icons">close</i> </button>
        <h4 class="modal-title" id="myModalLabel">Comunicacion No. {{ codOficioIntModal }} | Referencia ( {{ codOficioRefModal }} )</h4>
        <!-- Loader de Carga de los Datos -->
        <div id="loader-2" *ngIf="loading_table == 'show'" >
          <img src="assets/images/loading_2.gif" alt="Cargando Tareas" style="width:25px;">
        </div>
      </div>

      <div class="modal-body">
        <!-- Formulario del Oficio Asignado -->
          <form #finalizarOficioForm="ngForm" (ngSubmit)="onSubmit(finalizarOficioAsignado, 1)" name="finalizarOficioForm" role="form">
            <!-- fila 1 del Formulario -->
            <h4>Finalización de Comunicación | {{ idCorrepEncModal }}</h4>
            <hr class="colorgraph">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="validationDefault01">Funcionario Asignado</label>
                <input type="text" class="form-control" id="validationDefault01" placeholder="Funcionario Asignado"
                       value="{{ nombre1FuncModal }} {{ nombre2FuncModal }} {{ apellido1FuncModal }} {{ apellido2FuncModal }} " disabled>
              </div>

            </div>

            <!-- fila 2 del Formulario -->
            <div class="row">
              <div class="col-md-12 mb-4">
                <!-- <label for="validationDefault01">Descripción del Oficio</label> -->
                <textarea #descripcionOficio="ngModel" type="text" name="descripcionOficio" id="descripcionOficio"
                        ngControl="descripcionOficio" [(ngModel)]="finalizarOficios.descripcionOficio" required maxlength="1400" minlength="15"
                        class="form-control" id="exampleFormControlTextarea1" placeholder="Descripción de la Comunicacion" rows="3">
                </textarea>
                <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.required" >La Descripción es obligatoria</small>
                <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.minlength" >Se nesesita por lo menos {{ descripcionOficio.errors.minlength.requiredLength }} caracteres</small>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12 mb-3">
                <!-- <label for="validationDefault02">Actividad realizada</label> -->
                <input type="text" class="form-control" [(ngModel)]="finalizarOficios.actividadOficio" name="actividadOficio" id="actividadOficio"
                    placeholder="Actividad realizada" required value="">

              </div>
            </div>

            <div class="row">
              <div class="col-md-4 mb-3">
                <!-- <label for="validationDefault02">Actividad realizada</label> -->
                <input type="text" class="form-control" [(ngModel)]="finalizarOficios.codOficioRespuesta" name="codOficioRespuesta" id="codOficioRespuesta"
                    placeholder="Comunicación de Respuesta" required value="{{ idCorrepEncModal }}" disabled>
              </div>
            </div>


            <!-- Seccion de Anexos -->
            <!-- <h4>Anexos</h4> -->
            <div class="row">
              <div class="col-xs-12 col-md-4 col-lg-6">
                <label for="exampleInputEmail1">Documento de soporte</label>
                <input #pdfDocumento="ngModel" type="file" class="form-control-file" id="pdfDocumento" name="pdfDocumento"
                     ngControl="pdfDocumento" [(ngModel)]="finalizarOficios.pdfDocumento" placeholder="Subir Pdf ..."
                     aria-describedby="fileHelp" (change)="fileChangeEvent($event)" value="foo">

                <!-- <image-upload url="http://172.17.3.90/sicdoc/symfony/web/uploads/contactos/imagen" [max]="2" [extensions]="['jpeg','png']"></image-upload> -->
              </div>
            </div>

            <hr>
            <div class="row">
              <div class="col-xs-12 col-md-8 col-lg-12">
                <!-- Barra de Progreso de Carga de la Imagen -->
                <div class="progress">
                    <div id="upload-progress-bar" class="progress-bar progress-bar-success"
                        role="progressbar"
                        aria-valuenow="0"
                        aria-valuemin="0"
                        aria-valuemax="0"
                        style="width:1%">
                    </div>
                </div>
                <p id="status"></p>
              </div>
            </div>

            <hr class="colorgraph">

            <!-- <button class="btn btn-primary" type="submit">Submit form</button> -->
            <!-- <button type="reset" class="btn btn-primary">Limpiar</button> -->
            <button class="btn btn-success" type="submit" [disabled]="!finalizarOficioForm.valid" style="cursor: pointer">Guardar</button>
            <button type="button" id="closeModalFinCom" class="btn btn-danger" data-dismiss="modal" style="cursor: pointer">Cerrar</button>
        </form>
    </div>
      <div class="modal-footer">

      </div>
</div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->
</div><!-- /.modal -->


    <!-- Modal de Oficio Respuesta Actividad -->
    <div *ngIf="idEstadoModal != 5 " class="modal fade" id="t_and_c_m2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
          data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" > <i class="material-icons">close</i> </button>
            <h4 class="modal-title" id="myModalLabel">Comunicación No. {{ codOficioIntModal }} | Referencia ( {{ codOficioRefModal }} )</h4>
            <!-- Loader de Carga de los Datos -->
            <div id="loader-2" *ngIf="loading_table == 'show'" >
              <img src="assets/images/loading_2.gif" alt="Cargando Tareas" style="width:25px;">
            </div>
          </div>

          <div class="modal-body">
            <!-- Formulario del Oficio Asignado -->
              <form #finalizarOficioForm="ngForm" (ngSubmit)="onSubmit(creacionOficioAsignado, 2)" name="finalizarOficioForm" role="form">
                <!-- fila 1 del Formulario -->
                <h4>Creacion de Comunicación de Respuesta | {{ idCorrepEncModal }}</h4>
                <hr class="colorgraph">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="validationDefault01">Funcionario Asignado</label>
                    <input type="text" class="form-control" id="validationDefault01" placeholder="First name"
                           value="{{ nombre1FuncModal }} {{ nombre2FuncModal }} {{ apellido1FuncModal }} {{ apellido2FuncModal }} " disabled>
                  </div>

                </div>

                <!-- fila 2 del Formulario -->
                <div class="row">
                  <div class="col-md-12 mb-4">
                    <!-- <label for="validationDefault01">Descripción del Oficio</label> -->
                    <textarea #descripcionOficio="ngModel" type="text" name="descripcionOficio" id="descripcionOficio"
                            ngControl="descripcionOficio" [(ngModel)]="finalizarOficios.descripcionOficio" required maxlength="1400" minlength="15"
                            class="form-control" id="exampleFormControlTextarea1" placeholder="Descripción de la Comunicación" rows="3">
                    </textarea>
                    <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.required" >La Descripción es obligatoria</small>
                    <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.minlength" >Se nesesita por lo menos {{ descripcionOficio.errors.minlength.requiredLength }} caracteres</small>
                    <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.maxlength" >La capacidad maxima para la Descripcion es: 1400 caracteres</small>
                  </div>
                </div>

                <hr class="colorgraph">
                <!-- <button class="btn btn-primary" type="submit">Submit form</button> -->
                <!-- <button type="button" class="btn btn-primary">Limpiar</button> -->
                <button class="btn btn-success" type="submit" [disabled]="!finalizarOficioForm.valid" style="cursor: pointer">Guardar</button>
                <button type="button" id="closeModalComResp" class="btn btn-danger" data-dismiss="modal" style="cursor: pointer">Cerrar</button>
            </form>
        </div>
          <div class="modal-footer">

          </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<!-- Modal de Agregar Actividad a Comunicacion-->
<div *ngIf="idEstadoModal != 5 " class="modal fade" id="t_and_c_m3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
      data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" > <i class="material-icons">close</i> </button>
        <h4 class="modal-title" id="myModalLabel">Comunicación No. {{ codOficioIntModal }} | Referencia ( {{ codOficioRefModal }} )</h4>
        <!-- Loader de Carga de los Datos -->
        <div id="loader-2" *ngIf="loading_table == 'show'" >
          <img src="assets/images/loading_2.gif" alt="Cargando Tareas" style="width:25px;">
        </div>
      </div>

      <div class="modal-body">
        <!-- Formulario del Oficio Asignado -->
          <form #finalizarOficioForm="ngForm" (ngSubmit)="onSubmit(agregarActividadResp, 3)" name="finalizarOficioForm" role="form">
            <!-- fila 1 del Formulario -->
            <h4>Agregar Actividad a Comunicacion | {{ idCorrepEncModal }}</h4>
            <hr class="colorgraph">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="validationDefault01">Funcionario Asignado</label>
                <input type="text" class="form-control" id="validationDefault01" placeholder="First name"
                       value="{{ nombre1FuncModal }} {{ nombre2FuncModal }} {{ apellido1FuncModal }} {{ apellido2FuncModal }} " disabled>
              </div>

            </div>

            <!-- fila 2 del Formulario -->
            <div class="row">
              <div class="col-md-12 mb-4">
                <!-- <label for="validationDefault01">Descripción del Oficio</label> -->
                <textarea #descripcionOficio="ngModel" type="text" name="descripcionOficio" id="descripcionOficio"
                        ngControl="descripcionOficio" [(ngModel)]="finalizarOficios.descripcionOficio" required maxlength="1400" minlength="15"
                        class="form-control" id="exampleFormControlTextarea1" placeholder="Descripción de la Comunicacion" rows="3">
                </textarea>
                <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.required" >La Descripción es obligatoria</small>
                <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.minlength" >Se nesesita por lo menos {{ descripcionOficio.errors.minlength.requiredLength }} caracteres</small>
                <small class="form-text text-muted" *ngIf="descripcionOficio.errors?.maxlength" >La capacidad maxima para la Descripcion es: 1400 caracteres</small>
              </div>
            </div>

            <hr class="colorgraph">
            <!-- <button class="btn btn-primary" type="submit">Submit form</button> -->
            <!-- <button type="button" class="btn btn-primary">Limpiar</button> -->
            <button class="btn btn-success" type="submit" [disabled]="!finalizarOficioForm.valid" style="cursor: pointer">Guardar</button>
            <button type="button" id="closeModalAgreCom" class="btn btn-danger" data-dismiss="modal" style="cursor: pointer">Cerrar</button>
        </form>
    </div>
      <div class="modal-footer">

      </div>
</div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

</div> <!--  Fin de container -->
